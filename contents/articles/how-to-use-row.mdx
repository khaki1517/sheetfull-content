---
icon: ⬇️
title: 行番号を取得するROW関数で連番を自動生成する
description:
date: 2025-03-15
tags: [row, arrayformula]
published: true
---

スプレッドシートでデータの集計や整形を行なっていると、一番左の列に ID になるような番号を入力したいことがよくあります。

`ROW`関数を使用することで、行の削除や挿入などのイレギュラーにも対応できる連番を自動で生成することが可能です。

## ROW 関数

ROW 関数は行番号を取得する関数です。

```
=ROW(A1)
```

上記のように入力した場合は`1`という結果が返ってきます。

引数は省略することができ、`=ROW()`と入力することで関数を入力したセルの行番号を取得することができます。

## A 列に行番号を表示

```
=ARRAYFORMULA(ROW(U2:U)-1)
```

`ARRAYFORMULA`関数と組み合わせることで、全てのセルに関数を入れることなく連番を展開できます。

`-1`としているのは 1 行目が見出しとして使われるケースが多いため、2 行目から連番をスタートさせるためです。

[公式](https://support.google.com/docs/answer/3093316?hl=ja)
